LIB = libmacro.a
OBJS = MacroBison.o MacroDriver.o MacroFlex.o MacroValue.o
CXX = g++
LD = g++
# The -I.. is for <FlexLexer.h>
CXXFLAGS = @R_CXXFLAGS@  @R_CXXPICFLAGS@ @DEFS@ -I..
LEX = @LEX@
YACC = @YACC@

all : $(LIB)

$(LIB) : $(OBJS)
	$(AR) -rucs $@ $^

# dependencies on headers
MacroBison.o : MacroBison.cc MacroBison.hh MacroDriver.hh
MacroDriver.o : MacroDriver.cc MacroDriver.hh
MacroFlex.o : MacroFlex.cc MacroDriver.hh ../FlexLexer.h
MacroValue.o : MacroDriver.hh

# rules for flex and bison
MacroFlex.cc: MacroFlex.ll
	$(LEX) -o MacroFlex.cc MacroFlex.ll

MacroBison.cc MacroBison.hh location.hh stack.hh position.hh: MacroBison.yy
	$(YACC) -o MacroBison.cc MacroBison.yy

clean:
	-rm -r *.o
	-rm -r *.a
